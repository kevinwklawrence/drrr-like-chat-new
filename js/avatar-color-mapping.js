// Avatar to Color Mapping Configuration
const AVATAR_COLOR_MAPPING = {
    // Time-limited avatars
    'time-limited/': 'spooky',
    
    // Default avatars by specific file
    'default/_plain.png': 'blue',
    'default/furufu.png': 'lavender2',
    'default/_u0.png': 'black',
    'default/zbone.png': 'purple',
    'default/chef.png': 'purple',
    'default/f1.png': 'orange',
    'default/f2.png': 'orange2',
    'default/f3.png': 'lavender',
    'default/f4.png': 'pink',
    'default/f5.png': 'rose',
    'default/f6.png': 'red',
    'default/f7.png': 'peach',
    'default/m1.png': 'blue',
    'default/m2.png': 'green',
    'default/m3.png': 'tan',
    'default/m4.png': 'yellow',
    'default/m5.png': 'black',
    'default/m6.png': 'gray',
    'default/m7.png': 'cobalt',
    'default/m8.png': 'black',
    'default/m9.png': 'urban',
    'default/r_m5.png': 'peach',
    'default/r_m6.png': 'orange',
    'default/r_m8.png': 'cobalt',
    'default/r_m6.png': 'orange',
    'default/zr_nothing.png': 'cnegative',
    'default/zr_panda.png': 'brown',
    'default/zr_policeman2.png': 'pink',
    'default/r_u0.png': 'lavender',
    'default/zr_bone.png': 'red',
    'default/zpbrown.png': 'brown',
    'default/zpoliceman2.png': 'policeman2',
    'default/ztrain.png': 'navy',
    'default/znothing.png': 'negative',
    'default/zpanda.png': 'black',
    'default/zsmiley.png': 'black',
    'default/zr_smiley.png': 'caution',
    'mushoku/icon_gre.png': 'gray',
    'mushoku/icon_gree.png': 'green',
    'mushoku/icon_bb_tero.png': 'bbyellow',
    'mushoku/icon_bepo.png': 'orange',
    'mushoku/icon_bh.png': 'black',
    'mushoku/icon_hakumen.png': 'gray',
    'mushoku/icon_kakka.png': 'lavender2',
    'mushoku/icon_meme.png': 'toyred',
    'mushoku/icon_mudgreen.png': 'mudgreen',
    'mushoku/icon_shingenb.png': 'deepbrown',
    'mushoku/icon_teal2.png': 'teal2',
    'mushoku/icon_xsoncho.png': 'palegreen',
    'mushoku/icon_chii.png': 'chiipink',
    'mushoku/icon_ciel.png': 'forest',
    'mushoku/icon_hazama.png': 'forest',
    'mushoku/icon_keroro.png': 'palegreen',
    'mushoku/icon_dango.png': 'tan',
    'mushoku/icon_mihashi.png': 'tan',
    'mushoku/icon_law.png': 'tan',
    'mushoku/icon_hana.png': 'rust',
    'mushoku/icon_hongkong.png': 'toyred',
    'mushoku/icon_dark_blue.png': 'cobalt',
    'mushoku/icon_tama.png': 'cobalt',
    'mushoku/icon_shizou.png': 'navy',
    'mushoku/icon_haruhi.png': 'babyblue',
    'mushoku/icon_nozomu.png': 'sepia',
    'mushoku/icon_mika2.png': 'lavender',
    'mushoku/icon_hoshi.png': 'yellow',
    'mushoku/icon_konoe.png': 'yellow',
    'mushoku/icon_selty.png': 'bbyellow',
    'mushoku/icon_ren.png': 'yellow',
    'mushoku/r_icon_bh.png': 'deepbrown',
    'mushoku/r_icon_hakumen.png': 'peach',
    'drrrjp/blue.png': 'babyblue',
    'drrrjp/blue0.png': 'babyblue',
    'drrrjp/blue2.png': 'babyblue',
    'drrrjp/blue3.png': 'babyblue',
    'drrrjp/blue4.png': 'babyblue',
    'drrrjp/blue5.png': 'cobalt',
    'drrrjp/blue6.png': 'navy',
    'drrrjp/blue7.png': 'cobalt',
    'drrrjp/black.png': 'black',
    'drrrjp/black2.png': 'black',
    'drrrjp/black3.png': 'black',
    'drrrjp/black4.png': 'black',
    'drrrjp/black5.png': 'black',
    'drrrjp/black6.png': 'black',
    'drrrjp/brown.png': 'tan',
    'drrrjp/brown2.png': 'tan',
    'drrrjp/brown3.png': 'tan',
    'drrrjp/brown4.png': 'tan',
    'drrrjp/brown5.png': 'tan',
    'drrrjp/brown6.png': 'tan',
    'drrrjp/gray.png': 'gray',
    'drrrjp/gray2.png': 'gray',
    'drrrjp/gray3.png': 'gray',
    'drrrjp/gray4.png': 'gray',
    'drrrjp/gray5.png': 'gray',
    'drrrjp/green.png': 'green',
    'drrrjp/green0.png': 'green',
    'drrrjp/green2.png': 'green',
    'drrrjp/green3.png': 'green',
    'drrrjp/green4.png': 'green',
    'drrrjp/green44.png': 'forest',
    'drrrjp/orange.png': 'orange',
    'drrrjp/orange2.png': 'orange',
    'drrrjp/orange3.png': 'orange',
    'drrrjp/orange4.png': 'orange',
    'drrrjp/orange5.png': 'orange',
    'drrrjp/orange6.png': 'orange2',
    'drrrjp/pink.png': 'pink',
    'drrrjp/pink2.png': 'pink',
    'drrrjp/pink3.png': 'pink',
    'drrrjp/pink4.png': 'pink',
    'drrrjp/pink5.png': 'pink',
    'drrrjp/pink6.png': 'rose',
    'drrrjp/purple.png': 'lavender',
    'drrrjp/purple2.png': 'lavender',
    'drrrjp/purple3.png': 'lavender',
    'drrrjp/purple4.png': 'lavender',
    'drrrjp/purple5.png': 'lavender',
    'drrrjp/red.png': 'red',
    'drrrjp/red2.png': 'red',
    'drrrjp/red3.png': 'red',
    'drrrjp/red4.png': 'red',
    'drrrjp/red5.png': 'red',
    'drrrjp/red66.png': 'toyred',
    'drrrjp/yellow.png': 'bbyellow',
    'drrrjp/yellow2.png': 'bbyellow',
    'drrrjp/yellow3.png': 'bbyellow',
    'drrrjp/yellow4.png': 'bbyellow',
    'drrrjp/yellow5.png': 'bbyellow',
    'community/rat_chef.png': 'gray',
    'community/r_rat_chef.png': 'deepbrown',
    'drrrkari/icon_bear.png': 'deepbrown',
    'drrrkari/icon_bm.png': 'gray',
    'drrrkari/icon_girl.png': 'rose',
    'drrrkari/icon_kai.png': 'sepia',
    'drrrkari/icon_moza.png': 'lavender2',
    'drrrkari/icon_muff.png': 'black',
    'drrrkari/icon_muff_nyan.png': 'peach',
    'drrrkari/icon_neko.png': 'peach',
    'drrrkari/icon_neko2.png': 'gray',
    'drrrkari/icon_numakuro.png': 'blue',
    'drrrkari/icon_nyan.png': 'peach',
    'drrrkari/icon_orange.png': 'orange',
    'drrrkari/icon_purple.png': 'lavender',
    'drrrkari/icon_rab.png': 'pink',
    'drrrkari/icon_twin.png': 'red',
    'drrrkari/icon_usa.png': 'yellow',
    'drrrx2/bb1.png': 'blue',
    'drrrx2/bb2.png': 'cobalt',
    'drrrx2/bb3.png': 'navy',
    'drrrx2/bb4.png': 'cobalt',
    'drrrx2/bg1.png': 'navy',
    'drrrx2/blb1.png': 'black',
    'drrrx2/brb1.png': 'deepbrown',
    'drrrx2/gb1.png': 'green',
    'drrrx2/gb2.png': 'green',
    'drrrx2/gb3.png': 'forest',
    'drrrx2/gg1.png': 'palegreen',
    'drrrx2/grb1.png': 'black',
    'drrrx2/og1.png': 'orange2',
    'drrrx2/yg3.png': 'yellow',
    'drrrx2/pb1.png': 'lavender',
    'drrrx2/rb1.png': 'red',
    'drrrx2/pg1.png': 'pink',
    'drrrx2/prg1.png': 'rose',
    'drrrx2/prg2.png': 'lavender',
    'drrrx2/rg1.png': 'red',
    'drrrx2/yg1.png': 'yellow',
    'drrrx2/yg2.png': 'bbyellow',
    'secret/black1.png': 'black',
    'secret/black2.png': 'black',
    'secret/black3.png': 'black',
    'secret/black4.png': 'negative',
    'secret/blue1.png': 'blue',
    'secret/blue2.png': 'cobalt',
    'secret/blue3.png': 'cyan',
    'secret/blue4.png': 'cobalt',
    'secret/blue5.png': 'cobalt',
    'secret/blue6.png': 'cyan',
    'secret/blue7.png': 'blue',
    'secret/blue8.png': 'cyan',
    'secret/blue9.png': 'cobalt',
    'secret/brown1.png': 'tan',
    'secret/brown2.png': 'tan',
    'secret/brown3.png': 'tan',
    'secret/brown4.png': 'tan',
    'secret/gray1.png': 'gray',
    'secret/gray2.png': 'teal2',
    'secret/green1.png': 'forest',
    'secret/green2.png': 'green',
    'secret/green3.png': 'palegreen',
    'secret/green4.png': 'green',
    'secret/blue10.png': 'cyan',
    'secret/orange1.png': 'orange',
    'secret/pink1.png': 'pink',
    'secret/pink2.png': 'pink',
    'secret/pink3.png': 'pink',
    'secret/pink4.png': 'peach',
    'secret/pink5.png': 'peach',
    'secret/purple1.png': 'lavender2',
    'secret/purple2.png': 'lavender',
    'secret/purple3.png': 'purple',
    'secret/purple4.png': 'purple',
    'secret/red0.png': 'red',
    'secret/red1.png': 'peach',
    'secret/red2.png': 'peach',
    'secret/red3.png': 'peach',
    'secret/red4.png': 'peach',
    'secret/yellow1.png': 'yellow',
    'secret/yellow2.png': 'yellow',


    // Recolored avatars
    'recolored/a5.png': 'purple',
    'recolored/a13.png': 'cobalt',
    'recolored/a20.png': 'cobalt',
    'recolored/a22.png': 'orange',
    'recolored/a28.png': 'deepbrown',
    'recolored/a37.png': 'blue',
    'recolored/a40.png': 'forest',
    'recolored/a43.png': 'bbyellow',
    'recolored/a46.png': 'cyan',
    'recolored/accel.png': 'rose',
    'recolored/ayano.png': 'toyred',
    'recolored/black.png': 'navy',
    'recolored/bun.png': 'yellow',
    'recolored/chikusho.png': 'forest',
    'recolored/chinese.png': 'yellow',
    'recolored/claire.png': 'lavender',
    'recolored/daemon.png': 'red',
    'recolored/baymax.png': 'toyred',
    'recolored/erika.png': 'yellow',
    'recolored/grace.png': 'cyan',
    'recolored/guy.png': 'orange',
    'recolored/hagumi.png': 'purple',
    'recolored/haise.png': 'toyred',
    'recolored/ichi.png': 'red',
    'recolored/icon_alpha.png': 'toyred',
    'recolored/icon_anotherkun.png': 'cobalt',
    'recolored/icon_brook.png': 'orange',
    'recolored/icon_brooke.png': 'cobalt',
    'recolored/icon_brs.png': 'cyan',
    'recolored/icon_celes.png': 'babyblue',
    'recolored/icon_cutesiz.png': 'purple',
    'recolored/icon_datte3.png': 'cnegative',
    'recolored/icon_gin.png': 'red',
    'recolored/icon_gray_man.png': 'cobalt',
    'recolored/icon_grayman.png': 'cyan',
    'recolored/icon_hawkeyee.png': 'purple',
    'recolored/icon_hichigo.png': 'forest',
    'recolored/icon_inda.png': 'rose',
    'recolored/icon_izaya1.png': 'brown',
    'recolored/icon_izayao.png': 'toyred',
    'recolored/icon_jin.png': 'green',
    'recolored/icon_kakashi.png': 'bbyellow',
    'recolored/icon_karisawa.png': 'purple',
    'recolored/icon_karkat.png': 'toyred',
    'recolored/icon_kohlrak.png': 'cobalt',
    'recolored/icon_kururi.png': 'cnegative',
    'recolored/icon_kuzukin.png': 'yellow',
    'recolored/icon_mblack.png': 'lavender2',
    'recolored/icon_nerouu3.png': 'cyan',
    'recolored/icon_nerouu4.png': 'cobalt',
    'recolored/icon_nightfox0077.png': 'blue',
    'recolored/icon_pitchblack.png': 'cyan',
    'recolored/icon_princeofsass.png': 'red',
    'recolored/icon_rogue.png': 'forest',
    'recolored/icon_shinjiro.png': 'brown',
    'recolored/icon_slenderman.png': 'toyred',
    'recolored/icon_tsukiyomi210.png': 'red',
    'recolored/icon_yacchin.png': 'sepia',
    'recolored/icon_yaul.png': 'purple',
    'recolored/isudemo.png': 'pink',
    'recolored/jushiro.png': 'lavender',
    'recolored/jyastin.png': 'navy',
    'recolored/ken.png': 'red',
    'recolored/kira.png': 'red',
    'recolored/kyotachi.png': 'forest',
    'recolored/L.png': 'deepbrown',
    'recolored/mizu.png': 'cyan',
    'recolored/oreki.png': 'cyan',
    'recolored/plato_sasuke.png': 'purple',
    'recolored/pocketwatch.png': 'red',
    'recolored/rebirthsama.png': 'lavender',
    'recolored/redfox.png': 'cyan',
    'recolored/rf1.png': 'cobalt',
    'recolored/shinra.png': 'sepia',
    'recolored/shojo.png': 'purple',
    'recolored/tanaka.png': 'purple',
    
    
    
    
    // Color folder mappings (folder name determines default color)
    'blue/': 'blue',
    'red/': 'red',
    'green/': 'green',
    'purple/': 'lavender',
    'pink/': 'pink',
    'orange/': 'orange',
    'yellow/': 'yellow',
    'brown/': 'brown',
    'gray/': 'gray',
    'teal/': 'teal',
    'indigo/': 'indigo'
};

// Global fallback color when no mapping is found
const DEFAULT_FALLBACK_COLOR = 'black';

function getAvatarDefaultColor(avatarPath) {
    if (!avatarPath) return DEFAULT_FALLBACK_COLOR;
    
    // Check for exact file matches first
    if (AVATAR_COLOR_MAPPING[avatarPath]) {
        return AVATAR_COLOR_MAPPING[avatarPath];
    }
    
    // Check for folder-based matches
    for (const [pattern, color] of Object.entries(AVATAR_COLOR_MAPPING)) {
        if (pattern.endsWith('/') && avatarPath.startsWith(pattern)) {
            return color;
        }
    }
    
    // Extract folder from path and check if it matches a color name
    const folder = avatarPath.split('/')[0];
    const validColors = ['blue', 'purple', 'pink', 'cyan', 'mint', 'orange', 'green', 'yellow', 'red', 'teal', 'indigo','spooky'];
    
    if (validColors.includes(folder.toLowerCase())) {
        return folder.toLowerCase();
    }
    
    return DEFAULT_FALLBACK_COLOR;
}